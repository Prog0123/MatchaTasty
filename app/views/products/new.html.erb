<!-- ÊäïÁ®ø„Éö„Éº„Ç∏ -->
<h1 class="text-2xl font-bold mb-4">ÂïÜÂìÅ„ÇíÊäïÁ®ø„Åô„Çã</h1>

<!-- „Çπ„ÉÜ„ÉÉ„Éó„Éê„Éº -->
<div class="max-w-2xl w-full mx-auto px-4">
  <div class="bg-gray-200 rounded-full h-2.5 mb-2">
    <div id="progress-bar" class="bg-primary h-2.5 rounded-full transition-all duration-300 ease-in-out" style="width: 0%;"></div>
  </div>

<!-- „Çπ„ÉÜ„ÉÉ„ÉóÂêç -->
<div class="flex justify-between max-w-2xl mx-auto mb-8 px-4" id="step-labels">
  <% steps = [
    { number: 1, label: "ÂïÜÂìÅÊÉÖÂ†±", description: "ÂïÜÂìÅÂêç„ÉªÂ∫óËàóÂêç„ÇíÂÖ•Âäõ" },
    { number: 2, label: "Âë≥Ë¶öË©ï‰æ°", description: "5ÊÆµÈöé„ÅßË©ï‰æ°" },
    { number: 3, label: "„Ç≥„É°„É≥„Éà", description: "Ëá™Áî±„Å´ÊÑüÊÉ≥„ÇíÊõ∏„Åè" }
  ] %>

  <% steps.each_with_index do |step, index| %>
    <div class="flex flex-col items-center w-1/3">
      <!-- „Çπ„ÉÜ„ÉÉ„ÉóÁï™Âè∑„Ç¢„Ç§„Ç≥„É≥ -->
      <div id="step-circle-<%= index + 1 %>" class="w-8 h-8 rounded-full border-2 border-primary text-primary flex items-center justify-center mb-2 font-bold">
        <%= step[:number] %>
      </div>
      <div class="text-sm font-semibold text-gray-800"><%= step[:label] %></div>
      <div class="text-xs text-gray-500 text-center mt-1"><%= step[:description] %></div>
    </div>
  <% end %>
</div>

<%= form_with model: @product, local: true, class: "space-y-4" do |f| %>
  <% if @product.errors.any? %>
    <div class="alert alert-error">
      <ul>
        <% @product.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- „Çπ„ÉÜ„ÉÉ„Éó1: ÂïÜÂìÅÊÉÖÂ†± -->
<div class="max-w-xl mx-auto card bg-white shadow-md p-6 rounded-xl">
  <div id="step-1" class="step-panel" data-step="1">
    <div class="form-control">
      <%= f.label :name, "ÂïÜÂìÅÂêç", class: "label" %>
      <%= f.text_field :name, class: "input input-bordered w-full" %>
    </div>

    <div class="form-control">
      <%= f.label :category, "„Ç´„ÉÜ„Ç¥„É™", class: "label" %>
      <%= f.select :category, Product.categories.keys.map { |k| [k.titleize, k] }, {}, class: "select select-bordered w-full" %>
    </div>

    <div class="form-control">
      <%= f.label :image, "ÁîªÂÉè", class: "label" %>
      <%= f.file_field :image, class: "file-input file-input-bordered w-full" %>
    </div>

    <div class="flex justify-end mt-4">
      <button type="button" class="next-button btn btn-primary mt-4">Ê¨°„Å∏</button>
    </div>
  </div>

<!-- „Çπ„ÉÜ„ÉÉ„Éó2 & 3: „É¨„Éì„É•„ÉºÂÖ•Âäõ + „Ç≥„É°„É≥„Éà -->
<%= f.fields_for :review do |rf| %>
  <!-- „Çπ„ÉÜ„ÉÉ„Éó2: Âë≥Ë¶öË©ï‰æ° -->
  <div id="step-2" class="step-panel hidden" data-step="2">
    <div class="divider">„É¨„Éì„É•„ÉºÊÉÖÂ†±</div>
    <% [
      ["ÊøÉ„ÅïÔºàüçµÔºâ", :richness, "üçµ"],
      ["Ëã¶Âë≥Ôºà‚òïÔºâ", :bitterness, "‚òï"],
      ["Áîò„ÅïÔºàüç¨Ôºâ", :sweetness, "üç¨"],
      ["ÂæåÂë≥ÔºàüéêÔºâ", :aftertaste, "üéê"],
      ["Ë¶ã„ÅüÁõÆÔºàüëÄÔºâ", :appearance, "üëÄ"],
      ["Á∑èÂêàË©ï‰æ°Ôºà‚òÖÔºâ", :score, "‚òÖ"]
    ].each do |label, name, symbol| %>
      <div class="form-control mb-4" data-controller="stars" data-stars-name="product[review_attributes][<%= name %>]" data-stars-symbol="<%= symbol %>">
        <label class="label"><%= label %></label>
        <div class="flex space-x-1">
          <% 5.times do |i| %>
            <i class="star cursor-pointer text-2xl text-gray-400" data-action="click->stars#select" data-value="<%= i + 1 %>"><%= symbol %></i>
          <% end %>
        </div>
        <%= rf.hidden_field name, data: { stars_target: "input" } %>
      </div>
    <% end %>

    <!-- „Çπ„ÉÜ„ÉÉ„Éó2„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
    <div class="flex justify-between mt-4">
      <button type="button" class="prev-button btn btn-secondary">Êàª„Çã</button>
      <button type="button" class="next-button btn btn-primary">Ê¨°„Å∏</button>
    </div>
  </div>

  <!-- „Çπ„ÉÜ„ÉÉ„Éó3: „Ç≥„É°„É≥„Éà -->
  <div id="step-3" class="step-panel hidden" data-step="3">
    <div class="form-control">
      <%= rf.label :comment, "„Ç≥„É°„É≥„Éà", class: "label" %>
      <%= rf.text_area :comment, class: "textarea textarea-bordered w-full" %>
    </div>

    <!-- „Çπ„ÉÜ„ÉÉ„Éó3„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
    <div class="flex justify-between mt-4">
      <button type="button" class="prev-button btn btn-secondary">Êàª„Çã</button>
      <%= f.submit "ÂïÜÂìÅ„ÇíÊäïÁ®ø„Åô„Çã", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>

  <% end %>
</div>
